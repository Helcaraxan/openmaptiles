#generalized_tables:
#  # etldoc: imposm3 -> osm_building_polygon_gen1
#  building_polygon_gen1:
#    source: building_polygon
#    sql_filter: area>power(ZRES12,2) AND ST_IsValid(geometry)
#    tolerance: ZRES14

tables:
  # etldoc: imposm3 -> osm_building_polygon
  building_polygon:
    columns:
      - name: osm_id
        type: id
      - name: geometry
        type: validated_geometry
      - name: area
        type: area
      - name: colour
        key: building:colour
        type: string
      - name: building
        key: building
        type: string
      - name: buildingpart
        key: building:part
        type: string
    mapping:
      building:part:
        - __any__
      building:
        - __any__
      # these aeroway polygons all imply building=yes
      aeroway:
        - terminal
        - hangar
      location:
      - underground
    filters:
      reject:
        building: ["no", "none", "No"]
        building:part: ["no", "none", "No"]
        man_made: ["bridge"]
        location: ["underground"]
    type: polygon

  # etldoc: imposm3 -> osm_building_relation
  building_relation:
    columns:
      - name: osm_id
        type: id
      - name: geometry
        type: validated_geometry
      - name: area
        type: area
      - name: building
        key: building
        type: string
        from_member: true
      - name: buildingpart
        key: building:part
        type: string
        from_member: true
      - name: member
        type: member_id
      - name: index
        type: member_index
      - name: role
        type: member_role
        from_member: true
      - name: type
        type: member_type
    mapping:
      type: [building]
    type: relation_member
